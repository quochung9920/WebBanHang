!function(){CKEDITOR.plugins.add("leaflet",{requires:"widget",lang:"de,en,eu,ru",init:function(t){var a=t.config;window.dummy=function(){},"undefined"==typeof jQuery&&CKEDITOR.scriptLoader.load("//code.jquery.com/jquery-1.12.4.min.js");var e=t.lang.leaflet;CKEDITOR.dialog.add("leaflet",this.path+"dialogs/leaflet.js"),mapParserPath=CKEDITOR.getUrl(this.path+"scripts/mapParser.html"),t.widgets.add("leaflet",{dialog:"leaflet",allowedContent:"div(!leaflet_div,align-left,align-right,align-center,responsive-map)[*];iframe(!leaflet_iframe,responsive-map-iframe)[*];",template:'<div id="" class="leaflet_div" data-lat="" data-lon="" data-width="" data-height="" data-zoom="" data-popup-text="" data-tile="" data-minimap="" data-alignment="" data-responsive=""></div>',downcast:function(a){var e,i=a.attributes.id,s="leaflet_iframe-"+i.substring(12),n=t.document.$.getElementById(s),l="",d="",r="";n&&(e=n.contentDocument.getElementById("map_container"),e&&(l=e.getAttribute("data-zoom"),d=e.getAttribute("data-lat"),r=e.getAttribute("data-lon"))),a.attributes["data-zoom"]=l,a.attributes["data-lat"]=d,a.attributes["data-lon"]=r;var o=a.attributes["data-width"],u=a.attributes["data-height"],c=a.attributes["data-popup-text"],m=a.attributes["data-tile"],p=a.attributes["data-minimap"],f=a.attributes["data-responsive"],g=mapParserPath+"?lat="+d+"&lon="+r+"&width="+o+"&height="+u+"&zoom="+l+"&text="+c+"&tile="+m+"&minimap="+p+"&responsive="+f;return a.children[0].attributes.src=g,a.children[0].attributes["data-cke-saved-src"]=g,a},upcast:function(t){return"div"==t.name&&t.hasClass("leaflet_div")?t:void 0}}),t.ui.addButton("leaflet",{label:e.buttonLabel,command:"leaflet",icon:this.path+"icons/leaflet.png",toolbar:"insert,1"}),"object"==typeof a.contentsCss?a.contentsCss.push(CKEDITOR.getUrl(this.path+"css/contents.css")):a.contentsCss=[a.contentsCss,CKEDITOR.getUrl(this.path+"css/contents.css")]}})}();
